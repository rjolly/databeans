<project name="server" default="run" basedir=".">

  <target name="mkheapspace">
    <exec executable="dd">
      <arg value="if=/dev/zero"/>
      <arg value="of=heapspace"/>
      <arg value="count=512"/>
    </exec>
  </target>

  <target name="compile">
    <mkdir dir="classes"/>
    <unzip src="databeans.jar" dest="classes" overwrite="false"/>
    <javac srcdir="." destdir="classes"/>
    <rmic base="classes"
          includes="DepartmentImpl.class
                    EmployeeImpl.class"
    />
  </target>

  <target name="compile-debug">
    <mkdir dir="classes"/>
    <unzip src="databeans.jar" dest="classes" overwrite="false"/>
    <javac debug="on" srcdir="." destdir="classes"/>
    <rmic debug="on"
          base="classes"
          includes="DepartmentImpl.class
                    EmployeeImpl.class"
    />
  </target>

  <target name="run" depends="compile">
    <java fork="true" classpath="classes" classname="persistence.server.Server">
      <sysproperty key="java.rmi.server.codebase" value="http://localhost:2001/"/>
      <sysproperty key="java.security.policy" value="policy"/>
    </java>
  </target>

  <target name="debug" depends="compile-debug">
    <antcall target="run"/>
  </target>

  <target name="clean">
    <delete dir="classes" quiet="true"/>
  </target>

</project>
